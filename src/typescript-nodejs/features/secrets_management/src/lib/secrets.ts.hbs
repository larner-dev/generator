{{#includes features "secrets_management_doppler"}}
import got from "got";
{{/includes}}

export interface Secrets extends Record<string, string> {
  
}

{{#includes features "secrets_management_doppler"}}
const promise = got({
  method: 'GET',
  url: `https://${process.env.DOPPLER_TOKEN}@api.doppler.com/v3/configs/config/secrets/download?format=json`,
  throwHttpErrors: false
}).json<Secrets>();
delete process.env.DOPPLER_TOKEN;
const _secrets = await promise;
if (!_secrets.ok) {
  console.log("WARNING: Unable to retreive secrets from Doppler. Did you set the DOPPLER_TOKEN environment variable?");
}
export const secrets = _secrets.body || {};
{{/includes}}

{{#includes features "secrets_management_environment_variables"}}
export const secrets = process.env as Secrets;
{{/includes}}
